# Goose AI Instructions

> For Block's Goose AI agent
> Place in `.goose/instructions.md` or use in plan.md
> Generated by Backend Engineering Kit (bek)

## Project Context

This project uses Backend Engineering Kit patterns for production-grade backend code.

## Workflow

For every backend task:

### 1. Parse
Identify the scope:
- api, database, security, reliability, observability

### 2. Search
```bash
bek search "<query>" --scope <scope>
```

### 3. Apply
Follow the pattern's Solution section exactly.

### 4. Validate
```bash
bek gate --checklist <checklist-id>
```

## Coding Standards

### API Error Format
```json
{
  "error": {
    "code": "ERROR_CODE",
    "message": "Human readable",
    "requestId": "correlation-id"
  }
}
```

### Structured Logging
```json
{
  "level": "info",
  "message": "action description",
  "correlationId": "request-id"
}
```

### Database
- Use parameterized queries
- Index foreign keys
- Implement soft delete

### Security
- Validate all inputs
- Rate limit public endpoints
- Never log secrets

## Plan File Template

When creating a `plan.md` for Goose:

```markdown
# Plan: [Feature Name]

## Context
Using BEK pattern: [pattern-id]

## Tasks
1. [ ] Search pattern: `bek search "..."`
2. [ ] Implement following Solution section
3. [ ] Add error handling
4. [ ] Add logging
5. [ ] Run checklist: `bek gate --checklist ...`

## Checklist
- [ ] API Review items
- [ ] Security considerations
- [ ] Tests added
```

## Team Config

For `.goose/team-config.yaml`:
```yaml
instructions:
  - Follow BEK patterns for all backend code
  - Use structured logging
  - Validate with bek gate before committing
```
